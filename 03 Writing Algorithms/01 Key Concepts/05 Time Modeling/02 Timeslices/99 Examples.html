<p>
 The following examples demonstrate some common practices for timeslices time modeling.
</p>
<h4>
 Example 1: 6-Hour Consolidated Bars
</h4>
<p>
</p>
<div class="section-example-container testable">
 <pre class="csharp">public class TimeslicesTimeModelingAlgorithm : QCAlgorithm
{
    private Symbol _aapl;
    private TradeBarConsolidator _consolidator;

    public override void Initialize()
    {
        SetStartDate(2024, 9, 1);
        SetEndDate(2024, 12, 31);

        // Request AAPL data to trade it. We need a resolution denser than 6-hour for the consolidator.
        _aapl = AddEquity("AAPL", Resolution.Hour).Symbol;
            
        // Create a 6-hour consolidator for smoothing the noise.
        _consolidator = new TradeBarConsolidator(TimeSpan.FromHours(6));
        // Subscribe the consolidator to update with the security's data automatically.
        SubscriptionManager.AddConsolidator(_aapl, _consolidator);
    }
    
    public override void OnData(Slice slice)
    {
        if (slice.Bars.TryGetValue(_aapl, out var bar) &amp;&amp; _consolidator.WorkingBar != null)
        {
            // Trade on a rising trend, suggested by the current close is above the past hour open
            // and the past hour open is above the 6-hour bar open.
            if (_consolidator.WorkingBar.Open &lt; bar.Open &amp;&amp; bar.Open &lt; bar.Close)
            {
                SetHoldings(_aapl, 1m);
            }
            // Trade on a down trend, suggested by the current close is below the past hour open
            // and the past hour open is below the 6-hour bar open.
            else if (_consolidator.WorkingBar.Open &gt; bar.Open &amp;&amp; bar.Open &gt; bar.Close)
            {
                SetHoldings(_aapl, -1m);
            }
            // Otherwise, do not hold a position if there is no deterministic trend.
            else
            {
                Liquidate();
            }
        }
    }
}</pre>
 <script class="csharp-result" type="text">
  {
    "Total Orders": "229",
    "Average Win": "0.45%",
    "Average Loss": "-0.41%",
    "Compounding Annual Return": "-18.908%",
    "Drawdown": "8.600%",
    "Expectancy": "-0.148",
    "Start Equity": "100000",
    "End Equity": "93249.93",
    "Net Profit": "-6.750%",
    "Sharpe Ratio": "-1.732",
    "Sortino Ratio": "-1.881",
    "Probabilistic Sharpe Ratio": "5.407%",
    "Loss Rate": "59%",
    "Win Rate": "41%",
    "Profit-Loss Ratio": "1.10",
    "Alpha": "-0.188",
    "Beta": "0.046",
    "Annual Standard Deviation": "0.107",
    "Annual Variance": "0.011",
    "Information Ratio": "-1.6",
    "Tracking Error": "0.147",
    "Treynor Ratio": "-4.043",
    "Total Fees": "$466.76",
    "Estimated Strategy Capacity": "$25000000.00",
    "Lowest Capacity Asset": "AAPL R735QTJ8XC9X",
    "Portfolio Turnover": "181.61%",
    "Drawdown Recovery": "14",
    "OrderListHash": "dc07c8b186976fed652cc3f64bbf1100"
}
 </script>
 <pre class="python">class TimeslicesTimeModelingAlgorithm(QCAlgorithm):
    def initialize(self) -&gt; None:
        self.set_start_date(2024, 9, 1)
        self.set_end_date(2024, 12, 31)
        
        # Request AAPL data to trade it. We need a resolution denser than 6-hour for the consolidator.
        self.aapl = self.add_equity("AAPL", Resolution.Hour).symbol

        # Create a 6-hour consolidator for smoothing the noise.
        self.consolidator = TradeBarConsolidator(timedelta(hours=6))
        # Subscribe the consolidator to update with the security's data automatically.
        self.subscription_manager.add_consolidator(self.aapl, self.consolidator)

    def on_data(self, slice: Slice) -&gt; None:
        bar = slice.bars.get(self.aapl)
        if bar and self.consolidator.working_bar is not None:
            # Trade on a rising trend, suggested by the current close is above the past hour open
            # and the past hour open is above the 6-hour bar open.
            if self.consolidator.working_bar.open &lt; bar.open &lt; bar.close:
                self.set_holdings(self.aapl, 1)
            # Trade on a down trend, suggested by the current close is below the past hour open
            # and the past hour open is below the 6-hour bar open.
            elif self.consolidator.working_bar.open &gt; bar.open &gt; bar.close:
                self.set_holdings(self.aapl, -1)
            # Otherwise, do not hold a position if there is no deterministic trend.
            else:
                self.liquidate()</pre>
 <script class="python-result" type="text">
  {
    "Total Orders": "229",
    "Average Win": "0.45%",
    "Average Loss": "-0.41%",
    "Compounding Annual Return": "-18.908%",
    "Drawdown": "8.600%",
    "Expectancy": "-0.148",
    "Start Equity": "100000",
    "End Equity": "93249.93",
    "Net Profit": "-6.750%",
    "Sharpe Ratio": "-1.732",
    "Sortino Ratio": "-1.881",
    "Probabilistic Sharpe Ratio": "5.407%",
    "Loss Rate": "59%",
    "Win Rate": "41%",
    "Profit-Loss Ratio": "1.10",
    "Alpha": "-0.188",
    "Beta": "0.046",
    "Annual Standard Deviation": "0.107",
    "Annual Variance": "0.011",
    "Information Ratio": "-1.6",
    "Tracking Error": "0.147",
    "Treynor Ratio": "-4.043",
    "Total Fees": "$466.76",
    "Estimated Strategy Capacity": "$25000000.00",
    "Lowest Capacity Asset": "AAPL R735QTJ8XC9X",
    "Portfolio Turnover": "181.61%",
    "Drawdown Recovery": "14",
    "OrderListHash": "dc07c8b186976fed652cc3f64bbf1100"
}
 </script>
</div>
