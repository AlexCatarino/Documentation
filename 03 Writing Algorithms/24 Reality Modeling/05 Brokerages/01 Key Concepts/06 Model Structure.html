<p>Brokerage models should extend the <code>DefaultBrokerageModel</code> class. Extensions of the <code>DefaultBrokerageModel</code> class should implement the following methods:</p>

<div class="section-example-container">
<pre class="csharp">// In the Initialize method, set the custom brokerage model
SetBrokerageModel(new MyBrokerageModel());
    
// Define the custom brokerage model outside of the algorithm
class MyBrokerageModel : DefaultBrokerageModel
{
    public override decimal RequiredFreeBuyingPowerPercent { get; }

    public new IReadOnlyDictionary&lt;SecurityType, string&gt; DefaultMarkets  = new Dictionary&lt;SecurityType, string&gt;
    {
        {SecurityType.Equity, Market.USA}
    }.ToReadOnlyDictionary();

    public MyBrokerageModel(AccountType accountType = AccountType.Margin)
        : base(accountType)
    {
        
    }

    public override bool CanSubmitOrder(Security security, Order order,
        out BrokerageMessageEvent message)
    {
        return base.CanSubmitOrder(security, order, out message);
    }

    public override bool CanUpdateOrder(Security security, Order order,
        UpdateOrderRequest request, out BrokerageMessageEvent message)
    {
        return base.CanUpdateOrder(security, order, request, out message);
    }

    public override bool CanExecuteOrder(Security security, Order order)
    {
        return base.CanExecuteOrder(security, order);
    }

    public override void ApplySplit(List&lt;OrderTicket&gt; tickets, Split split)
    {
        base.ApplySplit(tickets, split);
    }

    public override decimal GetLeverage(Security security)
    {
        return base.GetLeverage(security);
    }

    public override IBenchmark GetBenchmark(SecurityManager securities)
    {
        return base.GetBenchmark(securities);
    }

    public override IFillModel GetFillModel(Security security)
    {
        return base.GetFillModel(security);
    }

    public override IFeeModel GetFeeModel(Security security)
    {
        return base.GetFeeModel(security);
    }

    public override ISlippageModel GetSlippageModel(Security security)
    {
        return base.GetSlippageModel(security);
    }

    public override ISettlementModel GetSettlementModel(Security security)
    {
        return base.GetSettlementModel(security);
    }

    public override IBuyingPowerModel GetBuyingPowerModel(Security security)
    {
        return base.GetBuyingPowerModel(security);
    }

    public override IMarginInterestRateModel GetMarginInterestRateModel(Security security)
    {
        return base.GetMarginInterestRateModel(security);
    }

    public override IShortableProvider GetShortableProvider(Security security)
    {
        return base.GetShortableProvider(security);
    }
}
</pre>
<pre class="python"># In the Initialize method, set the custom brokerage model
self.SetBrokerageModel(MyBrokerageModel())

# Define the custom brokerage model outside of the algorithm
class MyBrokerageModel(DefaultBrokerageModel):
    DefaultMarkets = {SecurityType.Equity: Market.USA}
    RequiredFreeBuyingPowerPercent = 0

    def __init__(self, accountType: AccountType = AccountType.Margin):
        self.AccountType = accountType
    
    def CanSubmitOrder(self, security: Security, order: Order,
         message: BrokerageMessageEvent) -&gt; bool:
        return super().CanSubmitOrder(security, order, message)

    def CanUpdateOrder(self, security: Security, order: Order,
         request: UpdateOrderRequest, message: BrokerageMessageEvent) -&gt; bool:
        return super().CanUpdateOrder(security, order, request, message)

    def CanExecuteOrder(self, security: Security, order: Order) -&gt; bool:
        return super().CanExecuteOrder(security, order)

    def ApplySplit(self, tickets: List[OrderTicket], split: Split) -&gt; None:
        super().ApplySplit(tickets, split)

    def GetLeverage(self, security: Security) -&gt; float:
        return super().GetLeverage(security)

    def GetBenchmark(self, securities: SecurityManager) -&gt; IBenchmark:
        return super().GetBenchmark(securities)

    def GetFillModel(self, security: Security) -&gt; IFillModel:
        return super().GetFillModel(security)

    def GetFeeModel(self, security: Security) -&gt; IFeeModel:
        return super().GetFeeModel(security)

    def GetSlippageModel(self, security: Security) -&gt; ISlippageModel:
        return super().GetSlippageModel(security)

    def GetSettlementModel(self, security: Security) -&gt; ISettlementModel:
        return super().GetSettlementModel(security)

    def GetBuyingPowerModel(self, security: Security) -&gt; IBuyingPowerModel:
        return super().GetBuyingPowerModel(security)

    def GetMarginInterestRateModel(self, security: Security) -&gt; IMarginInterestRateModel:
        return super().GetMarginInterestRateModel(security)

    def GetShortableProvider(self, security: Security) -&gt; IShortableProvider:
        return super().GetShortableProvider(security)</pre>
</div>

<p>For a full example algorithm, see <span class='python'><a href='https://www.quantconnect.com/terminal/processCache?request=embedded_backtest_8a4aba81b77e3f4500811672b31d1e80.html'>this backtest</a></span><span class='csharp'><a href='https://www.quantconnect.com/terminal/processCache?request=embedded_backtest_f5e27d225f4909bb6b533a1b797413ee.html'>this backtest</a></span>.</p>

<p>Custom brokerage models give you enormous control over your algorithm behavior and allow you to model virtually any brokerage in the world.</p>
