<p>
 The following examples demonstrate common practices for implementing count consolidator.
</p>
<h4>
 Example 1: Tick Count Consolidator
</h4>
<p>
</p>
<div class="section-example-container testable">
 <pre class="csharp">public class CountConsolidatorAlgorithm : QCAlgorithm
{
    private Symbol _spy;
    // Create EMA indicators for trade signal generation.
    private ExponentialMovingAverage _ema = new(200);
    // The _day variable controls trade daily when open.
    private int _day = -1;

    public override void Initialize()
    {
        SetStartDate(2024, 9, 1);
        SetEndDate(2024, 12, 31);
        
        // Request SPY data to feed to indicators and trade.
        _spy = AddEquity("SPY", Resolution.Tick).Symbol;

        // Create a 10000 trade tick consolidator to feed the "volume" bar to the EMA indicator for trend entry/exit signal.
        var tickConsolidator = new TickConsolidator(10000);

        // Subscribe the consolidators to SPY data to automatically update the indicators.
        RegisterIndicator(_spy, _ema, tickConsolidator);

        SetWarmUp(120);
    }

    public override void OnData(Slice slice)
    {
        if (_ema.IsReady &amp;&amp; slice.Ticks.TryGetValue(_spy, out var ticks) &amp;&amp; slice.Time.Day != _day)
        {
            // Obtain the latest quote price from the latest tick.
            var lastTick = ticks.MaxBy(x =&gt; x.EndTime);

            // Trade the trend by EMA crosses.
            if (lastTick.Price &gt; _ema &amp;&amp; !Portfolio[_spy].IsLong)
            {
                SetHoldings(_spy, 0.5m);
            }
            else if (lastTick.Price &lt; _ema &amp;&amp; !Portfolio[_spy].IsShort)
            {
                SetHoldings(_spy, -0.5m);
            }

            _day = slice.Time.Day;
        }
    }
}</pre>
 <script class="csharp-result" type="text">
  {
    "Total Orders": "17",
    "Average Win": "0.92%",
    "Average Loss": "-0.42%",
    "Compounding Annual Return": "0.257%",
    "Drawdown": "3.100%",
    "Expectancy": "-0.006",
    "Start Equity": "100000",
    "End Equity": "100085.55",
    "Net Profit": "0.086%",
    "Sharpe Ratio": "-1.157",
    "Sortino Ratio": "-1.639",
    "Probabilistic Sharpe Ratio": "25.833%",
    "Loss Rate": "69%",
    "Win Rate": "31%",
    "Profit-Loss Ratio": "2.18",
    "Alpha": "-0.051",
    "Beta": "-0.028",
    "Annual Standard Deviation": "0.045",
    "Annual Variance": "0.002",
    "Information Ratio": "-0.868",
    "Tracking Error": "0.118",
    "Treynor Ratio": "1.898",
    "Total Fees": "$17.00",
    "Estimated Strategy Capacity": "$0",
    "Lowest Capacity Asset": "SPY R735QTJ8XC9X",
    "Portfolio Turnover": "13.43%",
    "Drawdown Recovery": "85",
    "OrderListHash": "5b8f04f803d0f1a9e72b5ea0dc91a328"
}
 </script>
 <pre class="python">class CountConsolidatorAlgorithm(QCAlgorithm):
    # Create EMA indicators for trade signal generation.
    _ema = ExponentialMovingAverage(14)
    # The _day variable controls trade daily when open.
    _day = -1

    def initialize(self) -&gt; None:
        self.set_start_date(2024, 9, 1)
        self.set_end_date(2024, 12, 31)
        
        # Request SPY data to feed to indicators and trade.
        self.spy = self.add_equity("SPY", Resolution.TICK).symbol

        # Create a 10000 trade tick consolidator to feed the "volume" bar to the EMA indicator for trend entry/exit signal.
        tick_consolidator = TickConsolidator(10000)

        # Subscribe the consolidators to SPY data to automatically update the indicators.
        self.register_indicator(self.spy, self._ema, tick_consolidator)

        self.set_warm_up(120)

    def on_data(self, slice: Slice) -&gt; None:
        ticks = slice.ticks.get(self.spy)
        if self._ema.is_ready and ticks and self._day != slice.time.day:
            # Obtain the latest quote price from the latest tick.
            last_tick = sorted(ticks, key=lambda x: x.end_time, reverse=True)[0]

            ema = self._ema.current.value

            # Trade the trend by EMA crosses.
            if last_tick.price &gt; ema and not self.portfolio[self.spy].is_long:
                self.set_holdings(self.spy, 0.5)
            elif last_tick.price &lt; ema and not self.portfolio[self.spy].is_short:
                self.set_holdings(self.spy, -0.5)

            self._day = slice.time.day</pre>
 <script class="python-result" type="text">
  {
    "Total Orders": "42",
    "Average Win": "0.46%",
    "Average Loss": "-0.32%",
    "Compounding Annual Return": "14.188%",
    "Drawdown": "2.300%",
    "Expectancy": "0.361",
    "Start Equity": "100000",
    "End Equity": "104523.22",
    "Net Profit": "4.523%",
    "Sharpe Ratio": "0.781",
    "Sortino Ratio": "1.1",
    "Probabilistic Sharpe Ratio": "68.918%",
    "Loss Rate": "44%",
    "Win Rate": "56%",
    "Profit-Loss Ratio": "1.43",
    "Alpha": "0.044",
    "Beta": "-0.022",
    "Annual Standard Deviation": "0.055",
    "Annual Variance": "0.003",
    "Information Ratio": "-0.059",
    "Tracking Error": "0.122",
    "Treynor Ratio": "-1.958",
    "Total Fees": "$42.00",
    "Estimated Strategy Capacity": "$0",
    "Lowest Capacity Asset": "SPY R735QTJ8XC9X",
    "Portfolio Turnover": "33.73%",
    "Drawdown Recovery": "40",
    "OrderListHash": "68aec79c7af71ac6ff22970998fbe036"
}
 </script>
</div>
<h4>
 Other Examples
</h4>
<p>
 For more examples, see the following algorithms:
</p>
<div class="example-fieldset">
 <div class="example-legend">
  Demonstration Algorithms
 </div>
 <a class="python example-algorithm-link" href="https://github.com/QuantConnect/Lean/blob/master/Algorithm.Python/DataConsolidationAlgorithm.py" target="_BLANK">
  DataConsolidationAlgorithm.py
  <span class="badge-python pull-right">
   Python
  </span>
 </a>
 <a class="csharp example-algorithm-link" href="https://github.com/QuantConnect/Lean/blob/master/Algorithm.CSharp/DataConsolidationAlgorithm.cs" target="_BLANK">
  DataConsolidationAlgorithm.cs
  <span class="badge-csharp pull-right">
   C#
  </span>
 </a>
</div>
