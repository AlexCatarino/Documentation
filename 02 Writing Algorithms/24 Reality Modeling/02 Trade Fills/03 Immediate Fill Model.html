<p>The <code>ImmediateFillModel</code> fills trades completely and immediately, The fill price of each order depends on the order type.</p>

<h4>Market Orders</h4>

<p>The model determines the fill price of market orders based on the data format of the security subscription. The following table describes the fill logic of each data format:<br></p>



<table class="qc-table table">
    <thead>
        <tr>
            <th>Data Format</th>
            <th>Fill Logic</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>Tick</code></td>
            <td>If the most recent tick is of type <code>TickType.Quote</code>, buy orders fill at the ask price and sell orders fill at the bid price.<br>
                 If the most recent tick is of type <code>TickType.Trade</code>, orders fill at the last trade price.</td>
        </tr>
        <tr>
            <td><code>QuoteBar</code></td>
            <td>Buy orders fill at the most recent closing ask price.<br>Sell orders fill at the most recent closing bid price. <br></td>
        </tr>
        <tr>
            <td><code>TradeBar</code></td>
            <td>Orders fill at the most recent closing price.<br></td>
        </tr>
    </tbody>
</table>

<p>The model only fills market orders if the exchange is open.</p>


<h4>Limit Orders</h4>

<p>The model determines the fill logic of limit orders based on the data format of the security subscription. The following table describes the fill logic of each data format:<br></p>



<table class="qc-table table">
    <thead>
        <tr>
            <th>Data Format</th>
            <th><code>TickType</code></th>
            <th>Order Side
            </th><th>Fill Condition</th>
            <th>Fill Price</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>Tick</code></td>
            <td><code>Quote</code></td>
            <td>Buy</td>
            <td>quote price &lt; limit price</td>
            <td>min(quote price, limit price)</td>
        </tr>
        <tr>
            <td><code>Tick</code></td>
            <td><code>Quote</code></td>
            <td>Sell</td>
            <td>quote price &gt; limit price</td>
            <td>max(quote price, limit price)</td>
        </tr>
        <tr>
            <td><code>Tick</code></td>
            <td><code>Trade</code></td>
            <td>Buy</td>
            <td>trade price &lt; limit price</td>
            <td>min(trade price, limit price)</td>
        </tr>
        <tr>
            <td><code>Tick</code></td>
            <td><code>Trade</code></td>
            <td>Sell</td>
            <td>trade price &gt; limit price</td>
            <td>max(trade price, limit price)</td>
        </tr>
        <tr>
            <td><code>QuoteBar</code></td>
            <td><br></td>
            <td>Buy</td>
            <td>ask low price &lt; limit price</td>
            <td>min(ask high price, limit price)</td>
        </tr>
        <tr>
            <td><code>QuoteBar</code></td>
            <td><br></td>
            <td>Sell</td>
            <td>bid high price &gt; limit price</td>
            <td>max(bid low price, limit price)</td>
        </tr>
        <tr>
            <td><code>TradeBar</code></td>
            <td><br></td>
            <td>Buy</td>
            <td>low price &lt; limit price</td>
            <td>min(high price, limit price)</td>
        </tr>
        <tr>
            <td><code>TradeBar</code></td>
            <td><br></td>
            <td>Sell</td>
            <td>high price &gt; limit price</td>
            <td>max(low price, limit price)</td>
        </tr>
    </tbody>
</table>


<p>The model won't fill limit orders with stale data.</p>

<h4>Limit if Touched Orders</h4>

<p>The model converts a limit if touched order to a limit order when the trigger condition is met. The trigger condition depends on the data format of the security subscription and the order side. The following table describes the trigger logic of each data format and order side:</p>



<table class="qc-table table">
    <thead>
        <tr>
            <th>Data Format</th>
            <th><code>TickType</code></th>
            <th>Order Side</th>
            <th>Trigger Condition</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>Tick</code></td>
            <td><code>Quote</code></td>
            <td>Buy</td>
            <td>quote price &lt;= trigger price<br></td>
        </tr>
        <tr>
            <td><code>Tick</code></td>
            <td><code>Quote</code></td>
            <td>Sell</td>
            <td>quote price &gt;= trigger price</td>
        </tr>
        <tr>
            <td><code>Tick</code></td>
            <td><code>Trade</code></td>
            <td>Buy</td>
            <td>trade price &lt;= trigger price</td>
        </tr>
        <tr>
            <td><code>Tick</code></td>
            <td><code>Trade</code></td>
            <td>Sell</td>
            <td>trade price &gt;= trigger price</td>
        </tr>
        <tr>
            <td><code>TradeBar</code></td>
            <td><br></td>
            <td>Buy</td>
            <td>low price &lt;= trigger price</td>
        </tr>
        <tr>
            <td><code>TradeBar</code></td>
            <td><br></td>
            <td>Sell</td>
            <td>high price &gt;= trigger price</td>
        </tr>
    </tbody>
</table>


<p>After the limit if touched order triggers, to fill the order, the model checks the bid price for buy orders and the ask price for sell orders.</p>

<p>To get the bid price, the model uses the following procedure:</p>

<ol>
    <li>If the subscription provides <code>Tick</code> data and the most recent batch of ticks contains a buy quote, use the bid price.</li>
    <li>If the subscription provides <code>QuoteBar</code> data, use the closing bid price of the most recent <code>QuoteBar</code>.</li>
    <li>If the subscription provides <code>Tick</code> data and the most recent batch of ticks contains a tick of type <code>TickType.Trade</code>, use the last trade price.</li>
    <li>If the subscription provides <code>TradeBar</code> data, use the closing bid price of the most recent <code>QuoteBar</code>.</li>
</ol>

<p>To get the ask price, the model uses the following procedure:</p>

<ol>
    <li>If the subscription provides <code>Tick</code> data and the most recent batch of ticks contains an sell quote, use the ask price.</li>
    <li>If the subscription provides <code>QuoteBar</code> data, use the closing ask price of the most recent <code>QuoteBar</code>.</li>
    <li>If the subscription provides <code>Tick</code> data and the most recent batch of ticks contains a tick of type <code>TickType.Trade</code>, use the last trade price.</li>
    <li>If the subscription provides <code>TradeBar</code> data, use the closing bid price of the most recent <code>QuoteBar</code>.</li>
</ol>

<p>Buy orders fill when the bid price &lt;= limit price and sell orders fill when the ask price &gt;= limit price. The order fills at the limit price. The model won't trigger or fill limit if touched orders with stale data.<br></p>


<h4>Stop Market Orders</h4>

<p>The model determines the fill price of market orders based on the data format of the security subscription. The following table describes the fill logic of each data format:<br></p>



<table class="qc-table table">
    <thead>
        <tr>
            <th>Data Format</th>
            <th>Fill Logic</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>Tick</code></td>
            <td>If the most recent tick is of type <code>TickType.Quote</code>, buy orders fill at the ask price and sell orders fill at the bid price.<br>
                 If the most recent tick is of type <code>TickType.Trade</code>, orders fill at the last trade price.</td>
        </tr>
        <tr>
            <td><code>QuoteBar</code></td>
            <td>Buy orders fill at the most recent closing ask price.<br>Sell orders fill at the most recent closing bid price. <br></td>
        </tr>
        <tr>
            <td><code>TradeBar</code></td>
            <td>Orders fill at the most recent closing price.<br></td>
        </tr>
    </tbody>
</table>


<div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Only stop/filled if exchange is open</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Won't stop/fill on stale data<br></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Tick data</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - If the last tick is a quote<br></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If buying, converts to a market order when quotePrice &gt; stopPrice.
 Fills at max(stopPrice, quotePrice + slippage)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If selling, converts to a market order when quotePrice &lt; 
stopPrice. Fills at min(stopPrice, quotePrice - slippage)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - If the last tick is a trade tick</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If buying, converts to a market order when lastTradePrice &gt; 
stopPrice. Fills at max(stopPrice, lastTradePrice + slippage)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If selling, converts to a market order when lastTradePrice &lt; 
stopPrice. Fills at min(stopPrice, lastTradePrice - slippage)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - QuoteBar data</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If buying, converts to a market order when askHighPrice &gt; 
stopPrice. Fills at max(stopPrice, askClosePrice + slippage)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If selling, converts to a market order when bidLowPrice &lt; 
stopPrice. Fills at min(stopPrice, bidClosePrice - slippage)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - TradeBar data</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If buying, converts to a market order when highPrice &gt; stopPrice. 
Fills at max(stopPrice, closePrice + slippage)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -
 If selling, converts to a market order when lowPrice &lt; stopPrice. 
Fills at min(stopPrice, closePrice - slippage)</div></div>
<h4>Stop Limit Orders</h4>

<p>The model determines the fill price of market orders based on the data format of the security subscription. The following table describes the fill logic of each data format:<br></p>



<table class="qc-table table">
    <thead>
        <tr>
            <th>Data Format</th>
            <th>Fill Logic</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>Tick</code></td>
            <td>If the most recent tick is of type <code>TickType.Quote</code>, buy orders fill at the ask price and sell orders fill at the bid price.<br>
                 If the most recent tick is of type <code>TickType.Trade</code>, orders fill at the last trade price.</td>
        </tr>
        <tr>
            <td><code>QuoteBar</code></td>
            <td>Buy orders fill at the most recent closing ask price.<br>Sell orders fill at the most recent closing bid price. <br></td>
        </tr>
        <tr>
            <td><code>TradeBar</code></td>
            <td>Orders fill at the most recent closing price.<br></td>
        </tr>
    </tbody>
</table>

<div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Can stop/fill in regular trading hours or in pre/post market</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Won't stop/fill on stale data</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Tick data</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - If the last tick is a quote</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If buying, converts to limit order if quotePrice &gt; stopPrice. 
Fills when quotePrice &lt; limitPrice at min(quotePrice, limitPrice)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If selling, converts to limit order if quotePrice &lt; stopPrice. 
Fills when quotePrice &gt; limitPrice at max(quotePrice, limitPrice)<br></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - If the last tick is a trade tick</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If buying, converts to limit order if lastTradePrice &gt; stopPrice. 
Fills when lastTradePrice &lt; limitPrice at min(lastTradePrice , 
limitPrice)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - If selling, converts to limit 
order if lastTradePrice &lt; stopPrice. Fills when lastTradePrice &gt; 
limitPrice at max(lastTradePrice , limitPrice)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - QuoteBar data</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - if buying, converts to limit order when askHighPrice &gt; stopPrice. 
Fills when when askClosePrice &lt; limitPrice at min(askHighPrice, 
limitPrice)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - if selling, converts to limit order when bidLowPrice &lt; stopPrice. 
Fills when when bidClosePrice &gt; limitPrice at max(bidLowPrice, 
limitPrice)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - TradeBar data<br></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 - If buying, converts to limit order when highPrice &gt; stopPrice. 
Fills when closePrice &lt; limitPrice at min(highPrice, limitPrice)</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - If selling, converts to limit order when lowPrice &lt; stopPrice. 
Fills when when closePrice &gt; limitPrice at max(lowPrice, 
limitPrice)</div></div>
<h4>Market on Open Orders</h4><div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Won't fill on stale data</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Won't fill during pre-market<br></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Filled at the open price (QuoteBar if it's available, otherwise it's the TradeBar)</div></div>
<h4>Market on Closed Orders</h4><div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Won't fill on stale data</div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Filled at the market close (QuoteBar if it's available, otherwise it's the TradeBar)</div><div><br></div>