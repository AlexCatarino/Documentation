<p>When the remaining margin in your portfolio drops below 5% of the total portfolio value, we notify your algorithm through the <code>OnMarginCallWarning</code> event handler.</p>

<div class="section-example-container">
	<pre class="csharp">public override void OnMarginCallWarning()
{
    Debug("Warning: Close to margin call");
}</pre>
	<pre class="python">def OnMarginCallWarning(self):
    self.Debug(f"Warning: Close to margin call")</pre>
</div>

<p>Before we send the orders that the margin call model produces, we notify your algorithm through the <code>OnMarginCall</code> event handler. This notification gives your algorithm a chance to liquidate some positions or modify the margin call orders. To modify the orders, adjust the list of <code>SubmitOrderRequest</code> objects the event handler receives.</p>

<div class="section-example-container">
	<pre class="csharp">public override void OnMarginCall(List&lt;SubmitOrderRequest&gt; requests)
    foreach (var order in requests.ToList())
    {
        // liquidate an extra 10% each time we get a margin call to give us more padding
        var newQuantity = (int)(Math.Sign(order.Quantity) * order.Quantity * 1.1m);
        requests.Remove(order);
        requests.Add(new SubmitOrderRequest(order.OrderType, order.SecurityType, 
                                            order.Symbol, newQuantity, order.StopPrice, 
                                            order.LimitPrice, 0, Time, "OnMarginCall"));
    }</pre>
	<pre class="python">def OnMarginCall(self, requests):
    for order in requests:
        # liquidate an extra 10% each time we get a margin call to give us more padding
        newQuantity = int(np.sign(order.Quantity) * order.Quantity * 1.1)
        requests.remove(order)
        requests.append(SubmitOrderRequest(order.OrderType, order.SecurityType, order.Symbol, <br>                                           newQuantity, order.StopPrice, order.LimitPrice, 0, <br>                                           self.Time, "OnMarginCall"))
</pre>
</div>

<p><code>SubmitOrderRequest</code> objects have the following properties:</p>

<div data-tree="QuantConnect.Orders.SubmitOrderRequest"></div> 

<p>The following table describes the arguments of the <code>SubmitOrderRequest</code> constructor:</p>

<table class="qc-table table">
    <thead>
        <tr>
            <th>Argument</th>
            <th>Data Type</th>
            <th>Description</th>
            <th>Default Value</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>orderType</code></td>
	    <td><code>OrderType</code></td>
            <td>The order type to be submitted</td>
            <td></td>
        </tr>
        <tr>
            <td><code>securityType</code></td>
	    <td><code>SecurityType</code></td>
            <td>The security type of the asset</td>
            <td></td>
        </tr>
        <tr>
            <td><code>symbol</code></td>
	    <td><code>Symbol</code></td>
            <td>The symbol to be traded</td>
            <td></td>
        </tr>
        <tr>
            <td><code>quantity</code></td>
	    <td><code>decimal</code></td>
            <td>The number of units to order</td>
            <td></td>
        </tr>
        <tr>
            <td><code>stopPrice</code></td>
	    <td><code>decimal</code></td>
            <td>The stop price for stop orders</td>
            <td></td>
        </tr>
        <tr>
            <td><code>limitPrice</code></td>
	    <td><code>decimal</code></td>
            <td>The limit price for limit orders</td>
            <td></td>
        </tr>
        <tr>
            <td><code>triggerPrice</code></td>
	    <td><code>decimal</code></td>
            <td>The trigger price for limit if touched orders</td>
            <td></td>
        </tr>
        <tr>
            <td><code>time</code></td>
	    <td><code class="csharp">DateTime</code><code class="python">datetime</code></td>
            <td>The time this request was created</td>
            <td></td>
        </tr>
        <tr>
            <td><code>tag</code></td>
	    <td><code>string</code></td>
            <td>A custom tag for this request</td>
            <td></td>
        </tr>
        <tr>
            <td><code>properties</code></td>
	    <td><code>IOrderProperties</code></td>
            <td>The order properties for this request</td>
            <td><code class="csharp">null</code><code class="python">None</code></td>
        </tr>
    </tbody>
</table>
