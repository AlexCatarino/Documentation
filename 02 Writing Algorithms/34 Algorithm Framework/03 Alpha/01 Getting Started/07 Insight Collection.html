<p>The <code>InsightCollection</code> class is a helper class to manage insights. The class managers an internal dictionary that has the security <code>Symbol</code> as the key and a list of <code>Insight</code> objects as the value.</p>

<h4>Add Insights</h4>

<p>To add an <code>Insight</code> to the <code>InsightCollection</code>, call the <code>Add</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">_insightCollection.Add(insight);</pre>
	<pre class="python">self.insight_collection.Add(insight)</pre>
</div>

<p>To add a list of <code>Insight</code> objects, call the <code>AddRange</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">_insightCollection.AddRange(insights);</pre>
	<pre class="python">self.insight_collection.AddRange(insights)</pre>
</div>

<h4>Check Membership</h4>
<p>To check if an insight exists in the <code>InsightCollection</code>, call the <code>Contains</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var insightInCollection = _insightCollection.Contains(insight);</pre>
	<pre class="python">insight_in_collection = self.insight_collection.Contains(insight)</pre>
</div>

<p>To check if a Symbol exists in the <code>InsightCollection</code>, call the <code>ContainsKey</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var symbolInCollection = _insightCollection.ContainsKey(symbol);</pre>
	<pre class="python">symbol_in_collection = self.insight_collection.ContainsKey(symbol)</pre>
</div>

<p>To check if the <code>InsightCollection</code> has active insights for a certain Coordinated Universal Time (UTC), call the <code>HasActiveInsights</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var hasActiveInsights = _insightCollection.HasActiveInsights(symbol, utcTime);</pre>
	<pre class="python">has_active_insights = self.insight_collection.HasActiveInsights(symbol, utc_time)</pre>
</div>

<h4>Access Insights</h4>
<p>To access the <code>Insight</code> objects for a Symbol, index the <code>InsightCollection</code> with the <code>Symbol</code>.</p>
<div class="section-example-container">
	<pre class="csharp">var insights = _insightCollection[symbol];</pre>
	<pre class="python">insights = self.insight_collection[symbol]</pre>
</div>

<p>To iterate through the <code>InsightCollection</code>, call the <code>GetEnumerator</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var enumerator = _insightCollection.GetEnumerator();</pre>
	<pre class="python">enumerator = self.insight_collection.GetEnumerator()</pre>
</div>

<p>To get all of the active insights at a certain UTC time, call the <code>GetActiveInsights</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var activeInsights = _insightCollection.GetActiveInsights(utcTime);</pre>
	<pre class="python">active_insights = self.insight_collection.GetActiveInsights(utc_time)</pre>
</div>

<h4>Get the Next Expiry Time</h4>
<p>To get the next Insight expiry time, call the <code>GetNextExpiryTime</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var nextExpiry = _insightCollection.GetNextExpiryTime();</pre>
	<pre class="python">next_expiry = self.insight_collection.GetNextExpiryTime()</pre>
</div>

<h4>Remove Insights</h4>
<p>To remove an <code>Insight</code> from the <code>InsightCollection</code>, call the <code>Remove</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var removeSuccessful = _insightCollection.Remove(insight);</pre>
	<pre class="python">remove_successful = self.insight_collection.Remove(insight)</pre>
</div>

<p>To remove a subset of the <code>Insight</code> objects, pass a list of <code>Symbol</code> objects the <code>Clear</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">_insightCollection.Clear(symbols);</pre>
	<pre class="python">self.insight_collection.Clear(symbols)</pre>
</div>

<p>To remove all the <code>Insight</code> objects, call the <code>Clear</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">_insightCollection.Clear();</pre>
	<pre class="python">self.insight_collection.Clear()</pre>
</div>

<p>To remove all the expired insights at a certain UTC time, call the <code>RemoveExpiredInsights</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var expiredInsights = _insightCollection.RemoveExpiredInsights(utcTime);</pre>
	<pre class="python">expired_insights = self.insight_collection.RemoveExpiredInsights(utc_time)</pre>
</div>



<h4>Copy Insights</h4>
<p>To copy a subset of the <code>Insight</code> objects in the <code>InsightCollection</code> to an array, call the <code>CopyTo</code> method. The <code>arrayIndex</code></code> argument is the zero-based index in the array at which copying begins.</p>
<div class="section-example-container">
	<pre class="csharp">_insightCollection.CopyTo(array, arrayIndex);</pre>
	<pre class="python">self.insight_collection.CopyTo(array, arrayIndex)</pre>
</div>
