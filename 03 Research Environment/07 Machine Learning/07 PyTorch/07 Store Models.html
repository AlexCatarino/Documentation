<p>You can save and load <code>PyTorch</code> models using the ObjectStore.</p>

<h4>Save Models</h4>
<p>Don't use the <code>torch.save</code> method to save models because the tensor data will be lost and corrupt the save. Follow these steps to save models in the ObjectStore:</p>

<ol>
    <li>Set the key name of the model to be stored in the ObjectStore.</li>
    <div class="section-example-container">
        <pre class="python">model_key = "model"</pre>
    </div>

    <li>Call <code>GetFilePath</code> with the key's name to get the file path.</li>
    <div class="section-example-container">
        <pre class="python">file_name = qb.ObjectStore.GetFilePath(model_key)</pre>
    </div>

    <li>Call dump with the model and file path to save the model to the file path.</li>
    <div class="section-example-container">
        <pre class="python">joblib.dump(model, file_name)</pre>
    </div>

    <li>Call <code>Save</code> with the key's name to save the model into ObjectStore.</li>
    <div class="section-example-container">
        <pre class="python">qb.ObjectStore.Save(model_key)</pre>
    </div>
</ol>

<h4>Load Models</h4>
<p>You must save a model into the ObjectStore before you can load it from the ObjectStore. If you saved a model, follow these steps to load it:</p>
<ol>
    <li>Call the <code>ContainsKey</code> method.</li>
    <div class="section-example-container">
        <pre class="python">qb.ObjectStore.ContainsKey(model_key)</pre>
    </div>
    <p>This method returns a boolean that represents if the <code>model_key</code> is in the ObjectStore. If the ObjectStore does not contain the <code>model_key</code>, save the model using the <code>model_key</code> before you proceed.</p>

    <li>Call the <code>GetFilePath</code> method with the key.</li>
    <div class="section-example-container">
        <pre class="python">file_name = qb.ObjectStore.GetFilePath(model_key)</pre>
    </div>
    <p>This method returns the path where the model is stored.</p> 

    <li>Call the <code>load</code> method with the file path.</li>
    <div class="section-example-container">
        <pre class="python">loaded_model = joblib.load(file_name)</pre>
    </div>
    <p>This method returns the saved model.</p>
</ol>
