<p>You need some <a href="#03-Gathering-Data">historical data</a> to prepare the data for the model. If you have historical data, manipulate the <code>history</code> so that you can train and test the model. In this example, use the following features and labels:</p>
<ul>
    <li>Features: Daily percent change of the open, high, low, close, and volume of the SPY over the last 5 days</li>
    <li>Labels: Daily percent return of the SPY over the next day</li>
</ul>

<p>To prepare the data, run:</p>

<div class="section-example-container">
    <pre class="python">def prep_data(data, n_tsteps=5):    
    df = data.pct_change()[1:] # this helps make the data stationary
    
    features = []
    labels = []

    for i in range(len(df)-n_tsteps):
        input_data = df.iloc[i:i+n_tsteps].values
        features.append(input_data)
        label = df['close'].iloc[i+n_tsteps]
        labels.append(label)

    return np.array(features), np.array(labels)

X, y = prep_data(history)</pre>
</div>

<p>Figure 1 shows the difference in time for the features and labels.</p>

<p><b>Figure 1</b></p>
<p><i>The difference in time for features and labels</i></p>
<img style="max-width: 100%; display: block" src="https://cdn.quantconnect.com/i/tu/ml-keras-function.png">
<p><i>Note:</i> This figure illustrates the difference in time for the features and labels that are used to train a machine learning model.</p>
