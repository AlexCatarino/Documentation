<h4>Saving the Model</h4>
<p>We first serialize our model into a JSON string, then we save our model to <code>ObjectStore</code>. This way, the model doesn't need to be retrained, saving time and computational resources.</p>

<div class="section-example-container">
    <pre class="python">model_key = 'spy_model'

modelStr = json.dumps(serialize_keras_object(model))
qb.ObjectStore.Save(model_key, modelStr)</pre>
</div>

<h4>Loading the Model</h4>
<p>Let's first retreive the JSON for the Keras model that we saved in the ObjectStore, then restore our model from this JSON string</p>
<div class="section-example-container">
    <pre class="python">if qb.ObjectStore.ContainsKey(model_key):
    modelStr = qb.ObjectStore.Read(model_key)
    config = json.loads(modelStr)['config']
    loaded_model = Sequential.from_config(config)</pre>
</div>

<p>To ensure loading the model was successfuly, let's test the model.</p>
<div class="section-example-container">
    <pre class="python">y_hat = loaded_model.predict(X_test)
df = pd.DataFrame({'y': y_test.flatten(), 'y_hat': y_hat.flatten()})
df.plot(title='Model Performance: predicted vs actual %change in closing price', figsize=(15, 10))</pre>
</div>

<img style="max-width: 100%; display: block" src="https://cdn.quantconnect.com/i/tu/keras-load.png">