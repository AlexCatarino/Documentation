<meta name="tag" content="using data" />
<meta name="tag" content="assets" />
<meta name="tag" content="futures" />
<h5 style="font-weight: bold;">
    Backtesting
</h5>
<p>
QuantConnect hosts approximately 4000 symbols of futures contracts from Jan 2009 to present. The data 
    is provided by AlgoSeek who collects it directly from most popular exchanges. The only exchanges we do not have data for is the ICE exchange.
</p>
<p>
    Future data comes as trades and quotes, with tick, second and minute resolutions available.
</p>
<h5 style="font-weight: bold;">
    Live Trading
</h5>
<p>
	Live Trading futures data is sourced from Interactive Brokers. The data used comes from <i>your</i> futures data subscription. You must have a valid <a href="https://www.interactivebrokers.com/en/software/am/am/manageaccount/marketdatasubscriptions.htm">data subscription</a> with Interactive Brokers).
</p>
<h5 style="font-weight: bold;">
    Selecting Data
</h5>
<p>
To subscribe to futures data in QuantConnect you should first select the asset you'd like to trade; and then specify the filter by the contracts expiration that you'd like to see. 
</p>
<div class="section-example-container">
	<pre>
// Complete Add Future API - Including Default Parameters:
AddFuture(string symbol,
          Resolution resolution = Resolution.Minute,
          string market = null,
          bool fillDataForward = true,
          decimal leverage = 0m)      
</pre>
</div>
<p>
By default, the futures universe is filtered down to contracts that expire within 35 days. A difference set of contracts can be chosen with the <code>SetFilter</code> method:
<p>
		<div class="section-example-container">
			<pre>
var future = AddFuture(Futures.Indices.SP500EMini);
future.SetFilter(TimeSpan.FromDays(30), TimeSpan.FromDays(180));
</pre>
		</div>
		<p>
    Quotes and trades for your selected future contracts can be accessed in the Slice object in OnData event handler. The <code>FuturesChains</code> member contains a <code>FutureChain</code> object for each subscribed future:
</p>
		<div class="section-example-container">
			<pre>
// In Initialize
FutureSymbol = future.Symbol;

// In OnData
FuturesChain chain;
slice.FuturesChains.TryGetValue(FutureSymbol, out chain);
</pre>
		</div>
		<p>
An FuturesChain object has information about the underlying asset and futures contracts that were filtered by <code>SetFilter</code>:
<div class="section-example-container">
				<pre>
var underlying = chain.Underlying;
var contracts = chain.Contracts; 
</pre>
			</div>
			<p class="csharp fsharp">
We can use Linq on the contract list to select the contract(s) we want to trade.
</p>
			<div class="section-example-container" >
				<pre class="csharp" >
// In Initialize
var future = AddFuture(Futures.Indices.SP500EMini, Resolution.Minute);
future.SetFilter(TimeSpan.Zero, TimeSpan.FromDays(182));
// or Linq
future.SetFilter(universe => universe.Expiration(TimeSpan.Zero, TimeSpan.FromDays(182)));
</pre>
				<pre class="python" >
# In Initialize
future = self.AddFuture(Futures.Indices.SP500EMini, Resolution.Minute)
future.SetFilter(timedelta(0), timedelta(182))
# or Lambda
future.SetFilter(universe => universe.Expiration(timedelta(0), timedelta(182)))
</pre>
				<pre class="csharp" >
// In Initialize
FutureSymbol = future.Symbol;

// In OnData(Slice slice)
FuturesChain chain;
if (slice.FuturesChains.TryGetValue(FutureSymbol, out chain))
{
    var underlying = chain.Underlying;
    var contracts = chain.Contracts.Value; 
    foreach (var contract in contracts)
    {
        //
    }
}
</pre>
				<pre class="python" >
# In Initialize
self.FutureSymbol = future.Symbol;

# In OnData(self, slice)
for chain in slice.FutureChains.Values:
    contracts = chain.Contracts
    for contract in contracts:        pass</pre>
			</div>
