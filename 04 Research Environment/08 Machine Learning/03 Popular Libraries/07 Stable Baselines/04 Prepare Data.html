<p>
    You need some <a href="/docs/v2/research-environment/machine-learning/popular-libraries/stable-baselines#03-Get-Historical-Data">historical data</a> to prepare the data for the model. 
    If you have historical data, manipulate it to train and test the model.
    In this example, extract the close price series as the outcome and obtain the partial-differenced time-series of OHLCV values as the observation.
</p>

<div class="section-example-container">
    <pre class="python">history = df.unstack(0)
# we arbitrarily select weight 0.5 here, but ideally one should strike a balance between variance retained and stationarity.
partial_diff = (history.diff() * 0.5 + history * 0.5).iloc[1:].fillna(0)
history = history.close.iloc[1:]</pre>
</div>
