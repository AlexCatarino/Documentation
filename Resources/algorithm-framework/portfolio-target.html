
<p>The <code>PortfolioTargetCollection</code> class is a helper class to manage <code>PortfolioTarget</code> objects. The class manages an internal dictionary that has the security <code>Symbol</code> as the key and a <code>PortfolioTarget</code> as the value.</p>

<h4>Add Portfolio Targets</h4>
<p>To add a <code>PortfolioTarget</code> to the <code>PortfolioTargetCollection</code>, call the <code>Add</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">_targetsCollection.Add(portfolioTarget);</pre>
	<pre class="python">self.targets_collection.Add(portfolio_target)</pre>
</div>

<p>To add a list of <code>PortfolioTarget</code> objects, call the <code>AddRange</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">_targetsCollection.AddRange(portfolioTargets);</pre>
	<pre class="python">self.targets_collection.AddRange(portfolio_targets)</pre>
</div>

<h4>Check Membership</h4>
<p>To check if a <code>PortfolioTarget</code> exists in the <code>PortfolioTargetCollection</code>, call the <code>Contains</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var targetInCollection = _targetsCollection.Contains(portfolioTarget);</pre>
	<pre class="python">target_in_collection = self.targets_collection.Contains(portfolio_target)</pre>
</div>

<p>To check if a Symbol exists in the <code>PortfolioTargetCollection</code>, call the <code>ContainsKey</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var symbolInCollection = _targetsCollection.ContainsKey(symbol);</pre>
	<pre class="python">symbol_in_collection = self.targets_collection.ContainsKey(symbol)</pre>
</div>

<p>To get all the Symbol objects, use the <code>Keys</code> property.</p>
<div class="section-example-container">
	<pre class="csharp">var symbols = _targetsCollection.Keys;</pre>
	<pre class="python">symbols = self.targets_collection.Keys</pre>
</div>

<h4>Access Portfolio Targets</h4>

<p>To access the <code>PortfolioTarget</code> objects for a Symbol, index the <code>PortfolioTargetCollection</code> with the Symbol.</p>
<div class="section-example-container">
	<pre class="csharp">var portfolioTarget = _targetsCollection[symbol];</pre>
	<pre class="python">portfolio_target = self.targets_collection[symbol]</pre>
</div>

<p>To iterate through the <code>PortfolioTargetCollection</code>, call the <code>GetEnumerator</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">var enumerator = _targetsCollection.GetEnumerator();</pre>
	<pre class="python">enumerator = self.targets_collection.GetEnumerator()</pre>
</div>

<p>To get all the <code>PortfolioTarget</code> objects, use the <code>Values</code> property</p>
<div class="section-example-container">
	<pre class="csharp">var portfolioTargets = _targetsCollection.Values;</pre>
	<pre class="python">portfolio_targets = self.targets_collection.Values</pre>
</div>

<h4>Order Portfolio Targets by Margin Impact</h4>

<p>To get an enumerable where position reducing orders are executed first and the remaining orders are executed in decreasing order value, call the <code>OrderByMarginImpact</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">foreach (var target in _targetsCollection.OrderByMarginImpact(algorithm))
{
    // Place order
}</pre>
	<pre class="python">for target in self.targets_collection.OrderByMarginImpact(algorithm):
    # Place order</pre>
</div>
<p>This method won't return targets for securities that have no data yet. This method also won't return targets for which the sum of the current holdings and open orders quantity equals the target quantity.</p>

<h4>Remove Portfolio Targets</h4>
<p>To remove a <code>PortfolioTarget</code> from the <code>PortfolioTargetCollection</code>, call the <code>Remove</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">removeSuccessful = _targetsCollection.Remove(symbol);</pre>
	<pre class="python">remove_successful = self.targets_collection.Remove(symbol)</pre>
</div>

<p>To remove all the <code>PortfolioTarget</code> objects, call the <code>Clear</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">_targetsCollection.Clear();</pre>
	<pre class="python">self.targets_collection.Clear()</pre>
</div>

<p>To remove all the <code>PortfolioTarget</code> objects that have been fulfilled, call the <code>ClearFulfilled</code> method.</p>
<div class="section-example-container">
	<pre class="csharp">_targetsCollection.ClearFulfilled(algorithm);</pre>
	<pre class="python">self.targets_collection.ClearFulfilled(algorithm)</pre>
</div>

<h4>Copy Portfolio Targets</h4>
<p>To copy a subset of the <code>PortfolioTarget</code> objects in the <code>PortfolioTargetCollection</code> to an array, call the <code>CopyTo</code> method. The <code>arrayIndex</code> argument is the zero-based index in the array at which copying begins. </p>
<div class="section-example-container">
	<pre class="csharp">_targetsCollection.CopyTo(array, arrayIndex);</pre>
	<pre class="python">self.targets_collection.CopyTo(array, arrayIndex)</pre>
</div>
